{
  "version": 3,
  "sources": ["../../scripts/browser-history.js", "../../scripts/app.js"],
  "sourcesContent": ["const STORAGE_KEY = 'BrowserHistory';\nexport const DEFAULT_ROUTE = '/home';\nexport const BACK_BUTTON_ID = 'back-button-link';\nexport const NOTIFICATION_BANNER_GO_BACK_LINK_ID = 'notification-go-back-link';\n/**\n * Tracks a users browser history, stores it in local storage, and amends the back button link (if existing on page)\n */\nexport class BrowserHistory {\n  history = [];\n\n  get lastUrl() {\n    if (this.history.length > 0) {\n      if (this.getLastRef() == window.location.href) {\n        return this.history[this.history.length - 2];\n      }\n      return this.history[this.history.length - 1];\n    }\n\n    return DEFAULT_ROUTE;\n  }\n\n  constructor() {\n    this.history = this.getHistory();\n\n    this.ifNavigatingBackwardsRemoveUrl();\n    this.amendLinkHref(BACK_BUTTON_ID);\n    this.amendLinkHref(NOTIFICATION_BANNER_GO_BACK_LINK_ID);\n    this.tryAddUrl();\n  }\n\n  /**\n   * Adds current window href to history\n   */\n  tryAddUrl() {\n    const lastHref = this.history.length > 0 ? this.history[this.history.length - 1] : '';\n    if (window.location.href == lastHref) {\n      return;\n    }\n\n    this.history.push(window.location.href);\n    this.saveHistory();\n  }\n\n  getLastRef() {\n    return this.history.length > 0 ? this.history[this.history.length - 1] : '';\n  }\n\n  /**\n   * Checks to see if we are navigating backwards, if so removes URL(s) from history\n   * @returns {boolean} Whether we are navigating backwards or not\n   */\n  ifNavigatingBackwardsRemoveUrl() {\n    if (this.history.length == 0) {\n      return false;\n    }\n\n    const lastIndex = this.history.length - 2;\n\n    if (lastIndex < 0) {\n      return false;\n    }\n\n    const navigatingBackwards = this.history[lastIndex] == window.location.href;\n\n    if (!navigatingBackwards) {\n      return false;\n    }\n\n    this.history = this.history.slice(0, lastIndex);\n    this.saveHistory();\n    return true;\n  }\n\n  getHistory() {\n    if (this.shouldClearHistory()) {\n      this.clearHistory();\n    }\n\n    const fromStorage = localStorage.getItem(STORAGE_KEY);\n\n    if (fromStorage) {\n      return JSON.parse(fromStorage);\n    }\n\n    return [];\n  }\n\n  saveHistory() {\n    const stringified = JSON.stringify(this.history);\n    localStorage.setItem(STORAGE_KEY, stringified);\n  }\n\n  clearHistory() {\n    this.history = [];\n    this.saveHistory();\n  }\n\n  /**\n   * Gets the back button link from the page, if it exists amend HREF to be last url in history\n   */\n  amendLinkHref(id) {\n    const backButtonLink = document.getElementById(id);\n\n    if (!backButtonLink) {\n      return;\n    }\n\n    backButtonLink.setAttribute('href', this.lastUrl);\n  }\n\n  shouldClearHistory() {\n    return window.location.pathname == '/' || window.location.pathname == DEFAULT_ROUTE;\n  }\n}\n", "import { BrowserHistory } from './browser-history';\n\nnew BrowserHistory();\n"],
  "mappings": "MAAA,IAAMA,EAAc,iBACPC,EAAgB,QAChBC,EAAiB,mBACjBC,EAAsC,4BAItCC,EAAN,KAAqB,CAC1B,QAAU,CAAC,EAEX,IAAI,SAAU,CACZ,OAAI,KAAK,QAAQ,OAAS,EACpB,KAAK,WAAW,GAAK,OAAO,SAAS,KAChC,KAAK,QAAQ,KAAK,QAAQ,OAAS,CAAC,EAEtC,KAAK,QAAQ,KAAK,QAAQ,OAAS,CAAC,EAGtCH,CACT,CAEA,aAAc,CACZ,KAAK,QAAU,KAAK,WAAW,EAE/B,KAAK,+BAA+B,EACpC,KAAK,cAAcC,CAAc,EACjC,KAAK,cAAcC,CAAmC,EACtD,KAAK,UAAU,CACjB,CAKA,WAAY,CACV,IAAME,EAAW,KAAK,QAAQ,OAAS,EAAI,KAAK,QAAQ,KAAK,QAAQ,OAAS,CAAC,EAAI,GAC/E,OAAO,SAAS,MAAQA,IAI5B,KAAK,QAAQ,KAAK,OAAO,SAAS,IAAI,EACtC,KAAK,YAAY,EACnB,CAEA,YAAa,CACX,OAAO,KAAK,QAAQ,OAAS,EAAI,KAAK,QAAQ,KAAK,QAAQ,OAAS,CAAC,EAAI,EAC3E,CAMA,gCAAiC,CAC/B,GAAI,KAAK,QAAQ,QAAU,EACzB,MAAO,GAGT,IAAMC,EAAY,KAAK,QAAQ,OAAS,EAQxC,OANIA,EAAY,GAMZ,EAFwB,KAAK,QAAQA,CAAS,GAAK,OAAO,SAAS,MAG9D,IAGT,KAAK,QAAU,KAAK,QAAQ,MAAM,EAAGA,CAAS,EAC9C,KAAK,YAAY,EACV,GACT,CAEA,YAAa,CACP,KAAK,mBAAmB,GAC1B,KAAK,aAAa,EAGpB,IAAMC,EAAc,aAAa,QAAQP,CAAW,EAEpD,OAAIO,EACK,KAAK,MAAMA,CAAW,EAGxB,CAAC,CACV,CAEA,aAAc,CACZ,IAAMC,EAAc,KAAK,UAAU,KAAK,OAAO,EAC/C,aAAa,QAAQR,EAAaQ,CAAW,CAC/C,CAEA,cAAe,CACb,KAAK,QAAU,CAAC,EAChB,KAAK,YAAY,CACnB,CAKA,cAAcC,EAAI,CAChB,IAAMC,EAAiB,SAAS,eAAeD,CAAE,EAE5CC,GAILA,EAAe,aAAa,OAAQ,KAAK,OAAO,CAClD,CAEA,oBAAqB,CACnB,OAAO,OAAO,SAAS,UAAY,KAAO,OAAO,SAAS,UAAYT,CACxE,CACF,EC/GA,IAAIU",
  "names": ["STORAGE_KEY", "DEFAULT_ROUTE", "BACK_BUTTON_ID", "NOTIFICATION_BANNER_GO_BACK_LINK_ID", "BrowserHistory", "lastHref", "lastIndex", "fromStorage", "stringified", "id", "backButtonLink", "BrowserHistory"]
}
